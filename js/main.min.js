document.addEventListener("DOMContentLoaded",function(){const e=window.matchMedia("(prefers-reduced-motion: reduce)").matches,t=window.matchMedia("(hover: hover) and (pointer: fine)").matches,n=document.querySelector(".nav-toggle"),o=document.querySelector(".nav-links");if(n&&o){const e=()=>{n.classList.remove("active"),o.classList.remove("active"),n.setAttribute("aria-expanded","false")};n.addEventListener("click",function(){const e="true"===n.getAttribute("aria-expanded");n.classList.toggle("active"),o.classList.toggle("active"),n.setAttribute("aria-expanded",!e)}),o.querySelectorAll("a").forEach(t=>{t.addEventListener("click",e)}),document.addEventListener("keydown",function(t){"Escape"===t.key&&o.classList.contains("active")&&(e(),n.focus())}),document.addEventListener("click",function(t){!o.classList.contains("active")||o.contains(t.target)||n.contains(t.target)||e()})}const i=document.querySelector("nav");if(i){let e=0;const t=()=>{i.classList.toggle("nav-scrolled",window.scrollY>12)};t(),window.addEventListener("scroll",()=>{e||(e=window.requestAnimationFrame(()=>{t(),e=0}))},{passive:!0})}const s=document.querySelectorAll(".faq-item");s.forEach(e=>{const t=e.querySelector(".faq-question");t&&(t.addEventListener("click",()=>{const n=e.classList.contains("active");s.forEach(e=>{e.classList.remove("active"),e.querySelector(".faq-question").setAttribute("aria-expanded","false")}),n||(e.classList.add("active"),t.setAttribute("aria-expanded","true"))}),t.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t.click())}))}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=this.getAttribute("href");if("#"!==t&&t.length>1){e.preventDefault();const n=document.querySelector(t);if(n){const e=document.querySelector("nav"),t=e?e.offsetHeight:0,o=n.getBoundingClientRect().top+window.pageYOffset-t-20;window.scrollTo({top:o,behavior:"smooth"}),n.setAttribute("tabindex","-1"),n.focus({preventScroll:!0})}}})}),e&&(document.documentElement.style.scrollBehavior="auto");let a=document.querySelector(".scroll-progress");a||(a=document.createElement("div"),a.className="scroll-progress",a.setAttribute("aria-hidden","true"),document.body.prepend(a));let r=0;const c=()=>{r=0;const e=window.scrollY,t=document.documentElement.scrollHeight-window.innerHeight,n=t>0?e/t*100:0;a.style.width=`${n.toFixed(1)}%`};if(c(),window.addEventListener("scroll",()=>{r||(r=window.requestAnimationFrame(c))},{passive:!0}),!e){let e=document.getElementById("ambient-dots");e||(e=document.createElement("div"),e.className="ambient-dots",e.id="ambient-dots",e.setAttribute("aria-hidden","true"),document.body.prepend(e));const t=Math.min(Math.floor(window.innerWidth/50),35),n=document.createDocumentFragment();for(let e=0;e<t;e++){const e=document.createElement("span");e.className="ambient-dot";const t=100*Math.random(),o=100*Math.random(),i=4+6*Math.random(),s=8*Math.random();e.style.cssText=`left:${t}%;top:${o}%;--dot-dur:${i.toFixed(1)}s;--dot-delay:${s.toFixed(1)}s`,n.appendChild(e)}e.appendChild(n)}const d=document.querySelector(".hero");if(d&&!e&&t){let e=null,t=0,n=52,o=36;const i=()=>{e=d.getBoundingClientRect()},s=()=>{t=0,d.style.setProperty("--hero-spot-x",`${n.toFixed(2)}%`),d.style.setProperty("--hero-spot-y",`${o.toFixed(2)}%`)},a=()=>{t||(t=window.requestAnimationFrame(s))};d.addEventListener("pointerenter",()=>{i()},{passive:!0}),d.addEventListener("pointermove",t=>{e&&0!==e.width&&0!==e.height||i(),e&&0!==e.width&&0!==e.height&&(n=(t.clientX-e.left)/e.width*100,o=(t.clientY-e.top)/e.height*100,a())},{passive:!0}),d.addEventListener("pointerleave",()=>{n=52,o=36,a()},{passive:!0})}const l=document.querySelectorAll('main img[src*="/images/lf-photo-set/"]:not([data-no-accent])'),u="IntersectionObserver"in window,m=!e&&t;if(l.length>0){l.forEach((e,t)=>{e.classList.add("lf-accent-image");const n=e.closest("figure, .service-case-media")||e.parentElement;if(n){if(n.classList.add("lf-accent-media"),n.dataset.accentDelay=""+70*Math.min(t%6,5),e.complete)e.classList.add("lf-accent-loaded");else{const t=()=>e.classList.add("lf-accent-loaded");e.addEventListener("load",t,{once:!0}),e.addEventListener("error",t,{once:!0})}if(m){let e=null,t=0,o=0,i=0;const s=()=>{e=n.getBoundingClientRect()},a=()=>{if(t=0,!e||0===e.width||0===e.height)return;const s=(o-e.left)/e.width-.5,a=(i-e.top)/e.height-.5;n.style.setProperty("--accent-tilt-y",`${(3.5*s).toFixed(3)}deg`),n.style.setProperty("--accent-tilt-x",`${(-3.5*a).toFixed(3)}deg`)},r=()=>{t||(t=window.requestAnimationFrame(a))};n.addEventListener("pointerenter",()=>{s()},{passive:!0}),n.addEventListener("pointermove",t=>{e&&0!==e.width&&0!==e.height||s(),o=t.clientX,i=t.clientY,r()},{passive:!0}),n.addEventListener("pointerleave",()=>{t&&(window.cancelAnimationFrame(t),t=0),n.style.setProperty("--accent-tilt-x","0deg"),n.style.setProperty("--accent-tilt-y","0deg"),e=null},{passive:!0})}}});const t=document.querySelectorAll(".lf-accent-media");if(e||!u)t.forEach(e=>e.classList.add("lf-accent-in"));else{t.forEach(e=>e.classList.add("lf-accent-ready"));const e=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const n=Number(e.target.dataset.accentDelay||0);window.setTimeout(()=>{e.target.classList.add("lf-accent-in")},n),t.unobserve(e.target)}})},{threshold:.18,rootMargin:"0px 0px -30px 0px"});t.forEach(t=>e.observe(t))}}const h=document.querySelectorAll(".proof-pill, .service-card, .premium-difference-copy, .premium-point, .hub-cluster, .services-signal-card, .blog-signal-card, .work-metric-card, .content-block, .service-link-card, .insight-card, .final-cta");if(h.length>0)if(e||!("IntersectionObserver"in window))h.forEach(e=>e.classList.add("reveal-in"));else{h.forEach((e,t)=>{e.classList.add("reveal-ready"),e.style.transitionDelay=70*Math.min(t%6,5)+"ms"});const e=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("reveal-in"),t.unobserve(e.target))})},{threshold:.14,rootMargin:"0px 0px -36px 0px"});h.forEach(t=>e.observe(t))}let v=document.querySelector(".back-to-top");v||(v=document.createElement("button"),v.className="back-to-top",v.setAttribute("aria-label","Back to top"),v.innerHTML='<svg viewBox="0 0 24 24"><polyline points="18 15 12 9 6 15"></polyline></svg>',document.body.appendChild(v));let p=0;const f=()=>{p=0,v.classList.toggle("visible",window.scrollY>400)};f(),window.addEventListener("scroll",()=>{p||(p=window.requestAnimationFrame(f))},{passive:!0}),v.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});const g=document.querySelectorAll(".stats-image-card");if(g.length>0){const t=e=>{const t=e.querySelector(".stats-image-number");if(!t||t.dataset.counted)return;t.dataset.counted="1";const n=t.textContent.trim().match(/([\d.]+)(.*)/);if(n){((e,t,n)=>{const o=performance.now(),i=String(t).includes("."),s=a=>{const r=Math.min((a-o)/1200,1),c=(1-Math.pow(1-r,3))*t;e.textContent=i?c.toFixed(1)+n:Math.round(c)+n,r<1&&window.requestAnimationFrame(s)};window.requestAnimationFrame(s)})(t,parseFloat(n[1]),n[2])}};if(e||!("IntersectionObserver"in window))g.forEach(e=>e.classList.add("stats-visible"));else{const e=new IntersectionObserver((e,n)=>{e.forEach(e=>{if(e.isIntersecting){const o=Array.from(g).indexOf(e.target),i=80*Math.min(o,8);window.setTimeout(()=>{e.target.classList.add("stats-visible"),t(e.target)},i),n.unobserve(e.target)}})},{threshold:.15,rootMargin:"0px 0px -20px 0px"});g.forEach(t=>e.observe(t))}}});